<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">

    <title>notebook</title>
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="notebook_data/jquery-ui.css" type="text/css">
    <link rel="stylesheet" href="notebook_data/jquery.css" type="text/css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    


<script type="text/javascript" src="notebook_data/MathJax.js" charset="utf-8"></script>

<script type="text/javascript">
// MathJax disabled, set as null to distingish from *missing* MathJax,
// where it will be undefined, and should prompt a dialog later.
window.mathjax_url = "/proxy/absolute/b1ff8421c08311f3f2334ba463a41cd0/static/components/MathJax/MathJax.js";
</script>

<link rel="stylesheet" href="notebook_data/bootstrap-tour.css" type="text/css">
<link rel="stylesheet" href="notebook_data/codemirror.css">


    <link rel="stylesheet" href="notebook_data/style.css" type="text/css">
    

<link rel="stylesheet" href="notebook_data/override.css" type="text/css">
<link rel="stylesheet" href="notebook.html" id="kernel-css" type="text/css">


    <link rel="stylesheet" href="notebook_data/custom.css" type="text/css">
    <script src="notebook_data/promise.js" type="text/javascript" charset="utf-8"></script>
    <script src="notebook_data/index_004.js" type="text/javascript"></script>
    <script src="notebook_data/index_002.js" type="text/javascript"></script>
    <script src="notebook_data/index_003.js" type="text/javascript"></script>
    <script src="notebook_data/require.js" type="text/javascript" charset="utf-8"></script>
    <script>
      require.config({
          
          urlArgs: "v=20200417171913",
          
          baseUrl: 'https://jupyter-static.datacamp.com/static/',
          paths: {
            'auth/js/main': 'auth/js/main.min',
            custom : '/proxy/absolute/b1ff8421c08311f3f2334ba463a41cd0/custom',
            nbextensions : '/proxy/absolute/b1ff8421c08311f3f2334ba463a41cd0/nbextensions',
            kernelspecs : '/proxy/absolute/b1ff8421c08311f3f2334ba463a41cd0/kernelspecs',
            underscore : 'components/underscore/underscore-min',
            backbone : 'components/backbone/backbone-min',
            jquery: 'components/jquery/jquery.min',
            bootstrap: 'components/bootstrap/js/bootstrap.min',
            bootstraptour: 'components/bootstrap-tour/build/js/bootstrap-tour.min',
            'jquery-ui': 'components/jquery-ui/ui/minified/jquery-ui.min',
            moment: 'components/moment/moment',
            codemirror: 'components/codemirror',
            termjs: 'components/xterm.js/dist/xterm',
            typeahead: 'components/jquery-typeahead/dist/jquery.typeahead.min',
          },
          map: { // for backward compatibility
              "*": {
                  "jqueryui": "jquery-ui",
              }
          },
          shim: {
            typeahead: {
              deps: ["jquery"],
              exports: "typeahead"
            },
            underscore: {
              exports: '_'
            },
            backbone: {
              deps: ["underscore", "jquery"],
              exports: "Backbone"
            },
            bootstrap: {
              deps: ["jquery"],
              exports: "bootstrap"
            },
            bootstraptour: {
              deps: ["bootstrap"],
              exports: "Tour"
            },
            "jquery-ui": {
              deps: ["jquery"],
              exports: "$"
            }
          },
          waitSeconds: 30,
      });

      require.config({
          map: {
              '*':{
                'contents': 'services/contents',
              }
          }
      });

      // error-catching custom.js shim.
      define("custom", function (require, exports, module) {
          try {
              var custom = require('custom/custom');
              console.debug('loaded custom.js');
              return custom;
          } catch (e) {
              console.error("error loading custom.js", e);
              return {};
          }
      })
    </script>

    
    

<script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="services/contents" src="notebook_data/contents.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="custom/custom" src="notebook_data/custom.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nbextensions/dc_extension/index" src="notebook_data/index.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nbextensions/hide_input/main" src="notebook_data/main.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nbextensions/freeze/main" src="notebook_data/main_002.js"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nbextensions/widgets/notebook/js/extension" src="notebook_data/extension.html"></script><style type="text/css">div.MathJax_MathML {text-align: center; margin: .75em 0px; display: block!important}
.MathJax_MathML {font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
span.MathJax_MathML {display: inline!important}
.MathJax_mmlExBox {display: block!important; overflow: hidden; height: 1px; width: 60ex; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0}
[class="MJX-tex-oldstyle"] {font-family: MathJax_Caligraphic, MathJax_Caligraphic-WEB}
[class="MJX-tex-oldstyle-bold"] {font-family: MathJax_Caligraphic, MathJax_Caligraphic-WEB; font-weight: bold}
[class="MJX-tex-caligraphic"] {font-family: MathJax_Caligraphic, MathJax_Caligraphic-WEB}
[class="MJX-tex-caligraphic-bold"] {font-family: MathJax_Caligraphic, MathJax_Caligraphic-WEB; font-weight: bold}
@font-face /*1*/ {font-family: MathJax_Caligraphic-WEB; src: url('https://multiplexer-prod.datacamp.com/proxy/absolute/b1ff8421c08311f3f2334ba463a41cd0/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf')}
@font-face /*2*/ {font-family: MathJax_Caligraphic-WEB; font-weight: bold; src: url('https://multiplexer-prod.datacamp.com/proxy/absolute/b1ff8421c08311f3f2334ba463a41cd0/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Bold.otf')}
[mathvariant="double-struck"] {font-family: MathJax_AMS, MathJax_AMS-WEB}
[mathvariant="script"] {font-family: MathJax_Script, MathJax_Script-WEB}
[mathvariant="fraktur"] {font-family: MathJax_Fraktur, MathJax_Fraktur-WEB}
[mathvariant="bold-script"] {font-family: MathJax_Script, MathJax_Caligraphic-WEB; font-weight: bold}
[mathvariant="bold-fraktur"] {font-family: MathJax_Fraktur, MathJax_Fraktur-WEB; font-weight: bold}
[mathvariant="monospace"] {font-family: monospace}
[mathvariant="sans-serif"] {font-family: sans-serif}
[mathvariant="bold-sans-serif"] {font-family: sans-serif; font-weight: bold}
[mathvariant="sans-serif-italic"] {font-family: sans-serif; font-style: italic}
[mathvariant="sans-serif-bold-italic"] {font-family: sans-serif; font-style: italic; font-weight: bold}
@font-face /*3*/ {font-family: MathJax_AMS-WEB; src: url('https://multiplexer-prod.datacamp.com/proxy/absolute/b1ff8421c08311f3f2334ba463a41cd0/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf')}
@font-face /*4*/ {font-family: MathJax_Script-WEB; src: url('https://multiplexer-prod.datacamp.com/proxy/absolute/b1ff8421c08311f3f2334ba463a41cd0/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Script-Regular.otf')}
@font-face /*5*/ {font-family: MathJax_Fraktur-WEB; src: url('https://multiplexer-prod.datacamp.com/proxy/absolute/b1ff8421c08311f3f2334ba463a41cd0/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Regular.otf')}
@font-face /*6*/ {font-family: MathJax_Fraktur-WEB; font-weight: bold; src: url('https://multiplexer-prod.datacamp.com/proxy/absolute/b1ff8421c08311f3f2334ba463a41cd0/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Bold.otf')}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 0; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Blank; src: url('about:blank')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><link id="favicon" type="image/x-icon" rel="shortcut icon" href="https://multiplexer-prod.datacamp.com/static/base/images/favicon.ico"></head>

<body class="notebook_app  command_mode" data-base-url="/proxy/absolute/b1ff8421c08311f3f2334ba463a41cd0/" data-ws-url="" data-notebook-name="notebook.ipynb" data-notebook-path="production/users/5971671/kx2jqaz0d9/notebooks/notebook.ipynb" dir="ltr"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px none; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>

<noscript>
    <div id='noscript'>
      Jupyter Notebook requires JavaScript.<br>
      Please enable it to proceed. 
  </div>
</noscript>

<div id="header" style="display: block;">
  <div id="header-container" class="container">
  <div id="ipython_notebook" class="nav navbar-brand"><a href="https://multiplexer-prod.datacamp.com/proxy/absolute/b1ff8421c08311f3f2334ba463a41cd0/tree" title="dashboard">
      <img src="notebook_data/logo.png" alt="Jupyter Notebook">
  </a></div>

  


<span id="save_widget" class="save_widget">
    <span id="notebook_name" class="filename">notebook</span>
    <span class="checkpoint_status" title="no checkpoint"></span>
    <span class="autosave_status">(unsaved changes)</span>
</span>

<span id="kernel_logo_widget">
  
  <img class="current_kernel_logo" src="notebook_data/logo-64x64.png" title="Python 3" style="display: inline;">
  
</span>


  
  
  
  

    <span id="login_widget">
      
    </span>

  

  
  
  </div>
  <div class="header-bar"></div>

  
<div id="menubar-container" class="container">
<div id="menubar">
    <div id="menus" class="navbar navbar-default" role="navigation">
        <div class="container-fluid">
            <button type="button" class="btn btn-default navbar-btn navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <i class="fa fa-bars"></i>
              <span class="navbar-text">Menu</span>
            </button>
            <p id="kernel_indicator" class="navbar-text indicator_area">
              <span class="kernel_indicator_name">Python 3</span>
              <i id="kernel_indicator_icon" class="kernel_idle_icon" title="Kernel Idle"></i>
            </p>
            <i id="readonly-indicator" class="navbar-text" title="This notebook is read-only" style="display: none;">
                <span class="fa-stack">
                    <i class="fa fa-save fa-stack-1x"></i>
                    <i class="fa fa-ban fa-stack-2x text-danger"></i>
                </span>
            </i>
            <i id="modal_indicator" class="navbar-text modal_indicator" title="Command Mode"></i>
            <span id="notification_area"><div id="notification_kernel" class="notification_widget btn btn-xs navbar-btn undefined info" style="display: none;"><span></span></div><div id="notification_notebook" class="notification_widget btn btn-xs navbar-btn" style="display: none;"><span></span></div><div id="notification_trusted" class="notification_widget btn btn-xs navbar-btn" style="display: inline-block;"><span>Not Trusted</span></div></span>
            <div class="navbar-collapse collapse">
              <ul class="nav navbar-nav">
                <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">File</a>
                    <ul id="file_menu" class="dropdown-menu">
                        <li id="new_notebook" class="dropdown-submenu">
                            <a href="#">New Notebook</a>
                            <ul class="dropdown-menu" id="menu-new-notebook-submenu"><li id="new-notebook-submenu-python3"><a href="#">Python 3</a></li></ul>
                        </li>
                        <li id="open_notebook" title="Opens a new window with the Dashboard view">
                            <a href="#">Open...</a></li>
                        <!-- <hr/> -->
                        <li class="divider"></li>
                        <li id="copy_notebook" title="Open a copy of this notebook's contents and start a new kernel">
                            <a href="#">Make a Copy...</a></li>
                        <li id="rename_notebook"><a href="#">Rename...</a></li>
                        <li id="save_checkpoint"><a href="#">Save and Checkpoint</a></li>
                        <!-- <hr/> -->
                        <li class="divider"></li>
                        <li id="restore_checkpoint" class="dropdown-submenu"><a href="#">Revert to Checkpoint</a>
                          <ul class="dropdown-menu"><li class="disabled"><a>No checkpoints</a></li></ul>
                        </li>
                        <li class="divider"></li>
                        <li id="print_preview"><a href="#">Print Preview</a></li>
                        <li class="dropdown-submenu"><a href="#">Download as</a>
                            <ul id="download_menu" class="dropdown-menu">
                                <li id="download_ipynb"><a href="#">Notebook (.ipynb)</a></li>
                                <li id="download_script"><a href="#">Python (.py)</a></li>
                                <li id="download_html"><a href="#">HTML (.html)</a></li>
                                <li id="download_markdown"><a href="#">Markdown (.md)</a></li>
                                <li id="download_rst"><a href="#">reST (.rst)</a></li>
                                <li id="download_latex"><a href="#">LaTeX (.tex)</a></li>
                                <li id="download_pdf"><a href="#">PDF via LaTeX (.pdf)</a></li>
                            </ul>
                        </li>
                        <li class="dropdown-submenu hidden"><a href="#">Deploy as</a>
                            <ul id="deploy_menu" class="dropdown-menu"></ul>
                        </li>
                        <li class="divider"></li>
                        <li id="trust_notebook" title="Trust the output of this notebook">
                            <a href="#">Trust Notebook</a></li>
                        <li class="divider"></li>
                        <li id="kill_and_exit" title="Shutdown this notebook's kernel, and close this window">
                            <a href="#">Close and Halt</a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Edit</a>
                    <ul id="edit_menu" class="dropdown-menu">
                        <li id="cut_cell"><a href="#">Cut Cells</a></li>
                        <li id="copy_cell"><a href="#">Copy Cells</a></li>
                        <li id="paste_cell_above" class="disabled"><a href="#">Paste Cells Above</a></li>
                        <li id="paste_cell_below" class="disabled"><a href="#">Paste Cells Below</a></li>
                        <li id="paste_cell_replace" class="disabled"><a href="#">Paste Cells &amp; Replace</a></li>
                        <li id="delete_cell"><a href="#">Delete Cells</a></li>
                        <li id="undelete_cell" class="disabled"><a href="#">Undo Delete Cells</a></li>
                        <li class="divider"></li>
                        <li id="split_cell"><a href="#">Split Cell</a></li>
                        <li id="merge_cell_above"><a href="#">Merge Cell Above</a></li>
                        <li id="merge_cell_below"><a href="#">Merge Cell Below</a></li>
                        <li class="divider"></li>
                        <li id="move_cell_up" class="disabled"><a href="#">Move Cell Up</a></li>
                        <li id="move_cell_down" class="disabled"><a href="#">Move Cell Down</a></li>
                        <li class="divider"></li>
                        <li id="edit_nb_metadata"><a href="#">Edit Notebook Metadata</a></li>
                        <li class="divider"></li>
                        <li id="find_and_replace"><a href="#"> Find and Replace </a></li>
                        <li class="divider"></li>
                        <li id="cut_cell_attachments"><a href="#">Cut Cell Attachments</a></li>
                        <li id="copy_cell_attachments"><a href="#">Copy Cell Attachments</a></li>
                        <li id="paste_cell_attachments" class="disabled"><a href="#">Paste Cell Attachments</a></li>
                        <li class="divider"></li>
                        <li id="insert_image" class="disabled"><a href="#"> Insert Image </a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">View</a>
                    <ul id="view_menu" class="dropdown-menu">
                        <li id="toggle_header" title="Show/Hide the logo and notebook title (above menu bar)">
                            <a href="#">Toggle Header</a>
                        </li>
                        <li id="toggle_toolbar" title="Show/Hide the action icons (below menu bar)">
                            <a href="#">Toggle Toolbar</a>
                        </li>
                        <li id="toggle_line_numbers" title="Show/Hide line numbers in cells">
                            <a href="#">Toggle Line Numbers</a>
                        </li>
                        <li id="menu-cell-toolbar" class="dropdown-submenu">
                            <a href="#">Cell Toolbar</a>
                            <ul class="dropdown-menu" id="menu-cell-toolbar-submenu"><li data-name="None"><a href="#">None</a></li><li data-name="Edit%20Metadata"><a href="#">Edit Metadata</a></li><li data-name="Raw%20Cell%20Format"><a href="#">Raw Cell Format</a></li><li data-name="Slideshow"><a href="#">Slideshow</a></li><li data-name="Attachments"><a href="#">Attachments</a></li><li data-name="Tags"><a href="#">Tags</a></li></ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Insert</a>
                    <ul id="insert_menu" class="dropdown-menu">
                        <li id="insert_cell_above" title="Insert an empty Code cell above the currently active cell">
                            <a href="#">Insert Cell Above</a></li>
                        <li id="insert_cell_below" title="Insert an empty Code cell below the currently active cell">
                            <a href="#">Insert Cell Below</a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Cell</a>
                    <ul id="cell_menu" class="dropdown-menu">
                        <li id="run_cell" title="Run this cell, and move cursor to the next one">
                            <a href="#">Run Cells</a></li>
                        <li id="run_cell_select_below" title="Run this cell, select below">
                            <a href="#">Run Cells and Select Below</a></li>
                        <li id="run_cell_insert_below" title="Run this cell, insert below">
                            <a href="#">Run Cells and Insert Below</a></li>
                        <li id="run_all_cells" title="Run all cells in the notebook">
                            <a href="#">Run All</a></li>
                        <li id="run_all_cells_above" title="Run all cells above (but not including) this cell">
                            <a href="#">Run All Above</a></li>
                        <li id="run_all_cells_below" title="Run this cell and all cells below it">
                            <a href="#">Run All Below</a></li>
                        <li class="divider"></li>
                        <li id="change_cell_type" class="dropdown-submenu" title="All cells in the notebook have a cell type. By default, new cells are created as 'Code' cells">
                            <a href="#">Cell Type</a>
                            <ul class="dropdown-menu">
                              <li id="to_code" title="Contents will be sent to the kernel for execution, and output will display in the footer of cell">
                                  <a href="#">Code</a></li>
                              <li id="to_markdown" title="Contents will be rendered as HTML and serve as explanatory text">
                                  <a href="#">Markdown</a></li>
                              <li id="to_raw" title="Contents will pass through nbconvert unmodified">
                                  <a href="#">Raw NBConvert</a></li>
                            </ul>
                        </li>
                        <li class="divider"></li>
                        <li id="current_outputs" class="dropdown-submenu"><a href="#">Current Outputs</a>
                            <ul class="dropdown-menu">
                                <li id="toggle_current_output" title="Hide/Show the output of the current cell">
                                    <a href="#">Toggle</a>
                                </li>
                                <li id="toggle_current_output_scroll" title="Scroll the output of the current cell">
                                    <a href="#">Toggle Scrolling</a>
                                </li>
                                <li id="clear_current_output" title="Clear the output of the current cell">
                                    <a href="#">Clear</a>
                                </li>
                            </ul>
                        </li>
                        <li id="all_outputs" class="dropdown-submenu"><a href="#">All Output</a>
                            <ul class="dropdown-menu">
                                <li id="toggle_all_output" title="Hide/Show the output of all cells">
                                    <a href="#">Toggle</a>
                                </li>
                                <li id="toggle_all_output_scroll" title="Scroll the output of all cells">
                                    <a href="#">Toggle Scrolling</a>
                                </li>
                                <li id="clear_all_output" title="Clear the output of all cells">
                                    <a href="#">Clear</a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Kernel</a>
                    <ul id="kernel_menu" class="dropdown-menu">
                        <li id="int_kernel" title="Send Keyboard Interrupt (CTRL-C) to the Kernel">
                            <a href="#">Interrupt</a>
                        </li>
                        <li id="restart_kernel" title="Restart the Kernel">
                            <a href="#">Restart</a>
                        </li>
                        <li id="restart_clear_output" title="Restart the Kernel and clear all output">
                            <a href="#">Restart &amp; Clear Output</a>
                        </li>
                        <li id="restart_run_all" title="Restart the Kernel and re-run the notebook">
                            <a href="#">Restart &amp; Run All</a>
                        </li>
                        <li id="reconnect_kernel" title="Reconnect to the Kernel">
                            <a href="#">Reconnect</a>
                        </li>
                        <li id="shutdown_kernel" title="Shutdown the Kernel">
                            <a href="#">Shutdown</a>
                        </li>
                        <li class="divider"></li>
                        <li id="menu-change-kernel" class="dropdown-submenu">
                            <a href="#">Change kernel</a>
                            <ul class="dropdown-menu" id="menu-change-kernel-submenu"><li id="kernel-submenu-python3"><a href="#">Python 3</a></li></ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Help</a>
                    <ul id="help_menu" class="dropdown-menu">
                        
                        <li id="notebook_tour" title="A quick tour of the notebook user interface"><a href="#">User Interface Tour</a></li>
                        <li id="keyboard_shortcuts" title="Opens a tooltip with all keyboard shortcuts"><a href="#">Keyboard Shortcuts</a></li>
                        <li id="edit_keyboard_shortcuts" title="Opens a dialog allowing you to edit Keyboard shortcuts"><a href="#">Edit Keyboard Shortcuts</a></li>
                        <li class="divider"></li>
                        

						
                        
                            
                                <li><a rel="noreferrer" href="http://nbviewer.ipython.org/github/ipython/ipython/blob/3.x/examples/Notebook/Index.ipynb" target="_blank" title="Opens in a new window">
                                
                                    <i class="fa fa-external-link menu-icon pull-right"></i>
                                

                                Notebook Help
                                </a></li>
                            
                                <li><a rel="noreferrer" href="https://help.github.com/articles/markdown-basics/" target="_blank" title="Opens in a new window">
                                
                                    <i class="fa fa-external-link menu-icon pull-right"></i>
                                

                                Markdown
                                </a></li>
                            
                            
                        
                        <li id="kernel-help-links" class="divider"></li><li><a target="_blank" title="Opens in a new window" href="https://docs.python.org/3.6?v=20200417171913"><i class="fa fa-external-link menu-icon pull-right"></i><span>Python Reference</span></a></li><li><a target="_blank" title="Opens in a new window" href="https://ipython.org/documentation.html?v=20200417171913"><i class="fa fa-external-link menu-icon pull-right"></i><span>IPython Reference</span></a></li><li><a target="_blank" title="Opens in a new window" href="https://docs.scipy.org/doc/numpy/reference/?v=20200417171913"><i class="fa fa-external-link menu-icon pull-right"></i><span>NumPy Reference</span></a></li><li><a target="_blank" title="Opens in a new window" href="https://docs.scipy.org/doc/scipy/reference/?v=20200417171913"><i class="fa fa-external-link menu-icon pull-right"></i><span>SciPy Reference</span></a></li><li><a target="_blank" title="Opens in a new window" href="https://matplotlib.org/contents.html?v=20200417171913"><i class="fa fa-external-link menu-icon pull-right"></i><span>Matplotlib Reference</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://docs.sympy.org/latest/index.html?v=20200417171913"><i class="fa fa-external-link menu-icon pull-right"></i><span>SymPy Reference</span></a></li><li><a target="_blank" title="Opens in a new window" href="https://pandas.pydata.org/pandas-docs/stable/?v=20200417171913"><i class="fa fa-external-link menu-icon pull-right"></i><span>pandas Reference</span></a></li><li class="divider"></li>
                        <li title="About Jupyter Notebook"><a id="notebook_about" href="#">About</a></li>
                        
                    </ul>
                </li>
              </ul>
            </div>
        </div>
    </div>
</div>

<div id="maintoolbar" class="navbar">
  <div class="toolbar-inner navbar-inner navbar-nobg">
    <div id="maintoolbar-container" class="container toolbar"><div class="btn-group" id="save-notbook"><button class="btn btn-default" title="Save and Checkpoint" data-jupyter-action="jupyter-notebook:save-notebook"><i class="fa-save fa"></i></button></div><div class="btn-group" id="insert_above_below"><button class="btn btn-default" title="insert cell below" data-jupyter-action="jupyter-notebook:insert-cell-below"><i class="fa-plus fa"></i></button></div><div class="btn-group" id="cut_copy_paste"><button class="btn btn-default" title="cut selected cells" data-jupyter-action="jupyter-notebook:cut-cell"><i class="fa-cut fa"></i></button><button class="btn btn-default" title="copy selected cells" data-jupyter-action="jupyter-notebook:copy-cell"><i class="fa-copy fa"></i></button><button class="btn btn-default" title="paste cells below" data-jupyter-action="jupyter-notebook:paste-cell-below"><i class="fa-paste fa"></i></button></div><div class="btn-group" id="run_int"><button class="btn btn-default" title="run cell, select below" data-jupyter-action="jupyter-notebook:run-cell-and-select-next"><i class="fa-step-forward fa"></i></button><button class="btn btn-default" title="interrupt kernel" data-jupyter-action="jupyter-notebook:interrupt-kernel"><i class="fa-stop fa"></i></button><button class="btn btn-default" title="restart the kernel (with dialog)" data-jupyter-action="jupyter-notebook:confirm-restart-kernel"><i class="fa-repeat fa"></i></button></div><select id="cell_type" class="form-control select-xs"><option value="code">Code</option><option value="markdown" selected="selected">Markdown</option><option value="raw">Raw NBConvert</option><option value="heading">Heading</option><option value="multiselect" disabled="disabled" style="display: none;">-</option></select><div class="btn-group"><button class="btn btn-default" title="open the command palette" data-jupyter-action="jupyter-notebook:show-command-palette"><i class="fa-keyboard-o fa"></i></button></div></div>
  </div>
</div>
</div>

<div class="lower-header-bar"></div>

</div>

<div id="site" style="height: 225px; display: block;">


<div id="ipython-main-app">
    <div id="notebook_panel">
        <div id="notebook" tabindex="-1"><div class="container" id="notebook-container"><div class="cell text_cell rendered selected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(240, 254, 255);"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59999px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -10px; border-right-width: 20px; min-height: 354px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: currentcolor none medium;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 19.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-header cm-header-2">## 1. Inspecting transfusion.data file</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"</span><span class="cm-string cm-link">https://assets.datacamp.com/production/project_646/img/blood_donation.png</span><span class="cm-string">"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"float: right;"</span> <span class="cm-attribute">alt</span>=<span class="cm-string">"A pictogram of a blood bag with blood donation written in it"</span> <span class="cm-attribute">width</span>=<span class="cm-string">"200"</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>Blood transfusion saves lives - from replacing lost blood during major surgery or a serious injury to treating various illnesses and blood disorders. Ensuring that there's enough blood in supply whenever needed is a serious challenge for the health professionals. According to <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">href</span>=<span class="cm-string">"</span><span class="cm-string cm-link">https://www.webmd.com/a-to-z-guides/blood-transfusion-what-to-know#1</span><span class="cm-string">"</span><span class="cm-tag cm-bracket">&gt;</span>WebMD<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span>, "about 5 million Americans need a blood transfusion every year".<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>Our dataset is from a mobile blood donation vehicle in Taiwan. The Blood Transfusion Service Center drives to different universities and collects blood as part of a blood drive. We want to predict whether or not a donor will give blood the next time the vehicle comes to campus.<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>The data is stored in <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span>datasets/transfusion.data<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span> and it is structured according to RFMTC marketing model (a variation of RFM). We'll explore what that means later in this notebook. First, let's inspect the data.<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 354px;"></div><div class="CodeMirror-gutters" style="display: none; height: 374px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="1.-Inspecting-transfusion.data-file">1. Inspecting transfusion.data file<a class="anchor-link" href="#1.-Inspecting-transfusion.data-file">¶</a></h2>
<p><img src="notebook_data/blood_donation.png" style="float: right" alt="A pictogram of a blood bag with blood donation written in it" width="200"></p>
<p>Blood transfusion saves lives - from replacing lost blood during 
major surgery or a serious injury to treating various illnesses and 
blood disorders. Ensuring that there's enough blood in supply whenever 
needed is a serious challenge for the health professionals. According to
 <a href="https://www.webmd.com/a-to-z-guides/blood-transfusion-what-to-know#1" target="_blank">WebMD</a>, "about 5 million Americans need a blood transfusion every year".</p>
<p>Our dataset is from a mobile blood donation vehicle in Taiwan. The 
Blood Transfusion Service Center drives to different universities and 
collects blood as part of a blood drive. We want to predict whether or 
not a donor will give blood the next time the vehicle comes to campus.</p>
<p>The data is stored in <code>datasets/transfusion.data</code> and it 
is structured according to RFMTC marketing model (a variation of RFM). 
We'll explore what that means later in this notebook. First, let's 
inspect the data.</p></div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[2]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.60004px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 509px; margin-bottom: -10px; border-right-width: 20px; min-height: 45px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: currentcolor none medium;"><div class="CodeMirror-measure"><span><span>​</span>x</span></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span><span class="cm-comment"># Print out the first 5 lines from the transfusion.data file</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-operator">!</span><span class="cm-variable">head</span> <span class="cm-operator">-</span><span class="cm-variable">n5</span> <span class="cm-variable">datasets</span><span class="cm-operator">/</span><span class="cm-variable">transfusion</span>.<span class="cm-property">data</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 45px;"></div><div class="CodeMirror-gutters" style="display: none; height: 65px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>Recency (months),Frequency (times),Monetary (c.c. blood),Time (months),"whether he/she donated blood in March 2007"
2 ,50,12500,98 ,1
0 ,13,3250,28 ,1
1 ,16,4000,35 ,1
2 ,20,5000,45 ,1
</pre></div></div></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell unselected rendered" tabindex="2" style="display: none;"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[3]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.60004px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 10px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="display: block; right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 711px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="height: 10px; width: 10px;"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 711.4px; margin-bottom: -10px; border-right-width: 20px; min-height: 300px; padding-right: 0px; padding-bottom: 10px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: currentcolor none medium;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-operator">%%</span><span class="cm-variable">nose</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">last_input</span> = <span class="cm-variable">In</span>[<span class="cm-operator">-</span><span class="cm-number">2</span>]</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">import</span> <span class="cm-variable">re</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">try</span>:</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">bash_cmd</span> = <span class="cm-variable">re</span>.<span class="cm-property">search</span>(<span class="cm-string">r'get_ipython\(\).system\(\'(.*)\'\)'</span>, <span class="cm-variable">last_input</span>).<span class="cm-property">group</span>(<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">except</span> <span class="cm-variable">AttributeError</span>:</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">bash_cmd</span> = <span class="cm-string">''</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">test_head_command</span>():</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">assert</span> <span class="cm-string">'head'</span> <span class="cm-keyword">in</span> <span class="cm-variable">bash_cmd</span>, <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-string">"Did you use 'head' command?"</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">assert</span> (<span class="cm-string">'-n'</span> <span class="cm-keyword">in</span> <span class="cm-variable">bash_cmd</span>) <span class="cm-keyword">or</span> (<span class="cm-string">'-5'</span> <span class="cm-keyword">in</span> <span class="cm-variable">bash_cmd</span>), <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-string">"Did you use '-n' parameter?"</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">assert</span> <span class="cm-string">'5'</span> <span class="cm-keyword">in</span> <span class="cm-variable">bash_cmd</span>, <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-string">"Did you specify the correct number of lines to print?"</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 10px solid transparent; top: 300px;"></div><div class="CodeMirror-gutters" style="display: none; height: 330px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt"><bdi>Out</bdi>[3]:</div><div class="output_subarea output_text output_result"><pre>1/1 tests passed
</pre></div></div></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(240, 254, 255);"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.60004px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -10px; border-right-width: 20px; min-height: 82px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: currentcolor none medium;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 19.6667px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span><span class="cm-header cm-header-2">## 2. Loading the blood donations data</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>We now know that we are working with a typical CSV file (i.e., the delimiter is <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span>,<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span>, etc.). We proceed to loading the data into memory.<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 82px;"></div><div class="CodeMirror-gutters" style="display: none; height: 102px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="2.-Loading-the-blood-donations-data">2. Loading the blood donations data<a class="anchor-link" href="#2.-Loading-the-blood-donations-data">¶</a></h2>
<p>We now know that we are working with a typical CSV file (i.e., the delimiter is <code>,</code>, etc.). We proceed to loading the data into memory.</p></div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[4]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59998px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 458.4px; margin-bottom: -10px; border-right-width: 20px; min-height: 147px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: currentcolor none medium;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-comment"># Import pandas</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">import</span> <span class="cm-variable">pandas</span> <span class="cm-keyword">as</span> <span class="cm-variable">pd</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># Read in dataset</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">transfusion</span> = <span class="cm-variable">pd</span>.<span class="cm-property">read_csv</span>(<span class="cm-string">'datasets/transfusion.data'</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># Print out the first rows of our dataset</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">transfusion</span>.<span class="cm-property">head</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 147px;"></div><div class="CodeMirror-gutters" style="display: none; height: 167px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt"><bdi>Out</bdi>[4]:</div><div class="output_subarea output_html rendered_html output_result"><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="dataframe" border="1">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Recency (months)</th>
      <th>Frequency (times)</th>
      <th>Monetary (c.c. blood)</th>
      <th>Time (months)</th>
      <th>whether he/she donated blood in March 2007</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>50</td>
      <td>12500</td>
      <td>98</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>13</td>
      <td>3250</td>
      <td>28</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>16</td>
      <td>4000</td>
      <td>35</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>20</td>
      <td>5000</td>
      <td>45</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>24</td>
      <td>6000</td>
      <td>77</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell unselected rendered" tabindex="2" style="display: none;"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[5]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59998px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 10px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="display: block; right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 1191px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="height: 10px; width: 10px;"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 1192.1px; margin-bottom: -10px; border-right-width: 20px; min-height: 385px; padding-right: 0px; padding-bottom: 10px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: currentcolor none medium;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-operator">%%</span><span class="cm-variable">nose</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">last_output</span> = <span class="cm-variable">_</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">test_pandas_loaded</span>():</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">assert</span> <span class="cm-string">'pd'</span> <span class="cm-keyword">in</span> <span class="cm-builtin">globals</span>(), <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-string">"'pd' module not found. Please check your import statement."</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">test_transfusion_loaded</span>():</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">correct_transfusion</span> = <span class="cm-variable">pd</span>.<span class="cm-property">read_csv</span>(<span class="cm-string">"datasets/transfusion.data"</span>)</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">assert</span> <span class="cm-variable">correct_transfusion</span>.<span class="cm-property">equals</span>(<span class="cm-variable">transfusion</span>), <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-string">"transfusion not loaded correctly."</span></span></pre><pre class=" CodeMirror-line "><span>    </span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">test_head_output</span>():</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">try</span>:</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-keyword">assert</span> <span class="cm-string">"6000"</span> <span class="cm-keyword">in</span> <span class="cm-variable">last_output</span>.<span class="cm-property">to_string</span>()</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">except</span> <span class="cm-variable">AttributeError</span>:</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-keyword">assert</span> <span class="cm-keyword">False</span>, <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>            <span class="cm-string">"Please use transfusion.head() as the last line of code in the cell to inspect the data, not the display() or print() functions."</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">except</span> <span class="cm-variable">AssertionError</span>:</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-keyword">assert</span> <span class="cm-keyword">False</span>, <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>            <span class="cm-string">"Hmm, the output of the cell is not what we expected. You should see 6000 in the first five rows of the transfusion DataFrame."</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 10px solid transparent; top: 385px;"></div><div class="CodeMirror-gutters" style="display: none; height: 415px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt"><bdi>Out</bdi>[5]:</div><div class="output_subarea output_text output_result"><pre>3/3 tests passed
</pre></div></div></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(240, 254, 255);"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59998px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -10px; border-right-width: 20px; min-height: 337px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: currentcolor none medium;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 19.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-header cm-header-2">## 3. Inspecting transfusion DataFrame</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>Let's briefly return to our discussion of RFM model. RFM stands for Recency, Frequency and Monetary Value and it is commonly used in marketing for identifying your best customers. In our case, our customers are blood donors.<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>RFMTC is a variation of the RFM model. Below is a description of what each column means in our dataset:<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">ul</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">li</span><span class="cm-tag cm-bracket">&gt;</span>R (Recency - months since the last donation)<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">li</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">li</span><span class="cm-tag cm-bracket">&gt;</span>F (Frequency - total number of donation)<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">li</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">li</span><span class="cm-tag cm-bracket">&gt;</span>M (Monetary - total blood donated in c.c.)<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">li</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">li</span><span class="cm-tag cm-bracket">&gt;</span>T (Time - months since the first donation)<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">li</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">li</span><span class="cm-tag cm-bracket">&gt;</span>a binary variable representing whether he/she donated blood in March 2007 (1 stands for donating blood; 0 stands for not donating blood)<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">li</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">ul</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>It looks like every column in our DataFrame has the numeric type, which is exactly what we want when building a machine learning model. Let's verify our hypothesis.<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 337px;"></div><div class="CodeMirror-gutters" style="display: none; height: 357px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="3.-Inspecting-transfusion-DataFrame">3. Inspecting transfusion DataFrame<a class="anchor-link" href="#3.-Inspecting-transfusion-DataFrame">¶</a></h2>
<p>Let's briefly return to our discussion of RFM model. RFM stands for 
Recency, Frequency and Monetary Value and it is commonly used in 
marketing for identifying your best customers. In our case, our 
customers are blood donors.</p>
<p>RFMTC is a variation of the RFM model. Below is a description of what each column means in our dataset:</p>
<ul>
<li>R (Recency - months since the last donation)</li>
<li>F (Frequency - total number of donation)</li>
<li>M (Monetary - total blood donated in c.c.)</li>
<li>T (Time - months since the first donation)</li>
<li>a binary variable representing whether he/she donated blood in March
 2007 (1 stands for donating blood; 0 stands for not donating blood)</li>
</ul>
<p>It looks like every column in our DataFrame has the numeric type, 
which is exactly what we want when building a machine learning model. 
Let's verify our hypothesis.</p></div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[6]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59985px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 424.667px; margin-bottom: -10px; border-right-width: 20px; min-height: 45px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: currentcolor none medium;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span><span class="cm-comment"># Print a concise summary of transfusion DataFrame</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">transfusion</span>.<span class="cm-property">info</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 45px;"></div><div class="CodeMirror-gutters" style="display: none; height: 65px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 748 entries, 0 to 747
Data columns (total 5 columns):
Recency (months)                              748 non-null int64
Frequency (times)                             748 non-null int64
Monetary (c.c. blood)                         748 non-null int64
Time (months)                                 748 non-null int64
whether he/she donated blood in March 2007    748 non-null int64
dtypes: int64(5)
memory usage: 29.3 KB
</pre></div></div></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell unselected rendered" tabindex="2" style="display: none;"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[7]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.6001px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 10px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="display: block; right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 955px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="height: 10px; width: 10px;"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 955.967px; margin-bottom: -10px; border-right-width: 20px; min-height: 283px; padding-right: 0px; padding-bottom: 10px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: currentcolor none medium;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-operator">%%</span><span class="cm-variable">nose</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">strip_comment_lines</span>(<span class="cm-variable">cell_input</span>):</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-string">"""Returns cell input string with comment lines removed."""</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">return</span> <span class="cm-string">'\n'</span>.<span class="cm-property">join</span>(<span class="cm-variable">line</span> <span class="cm-keyword">for</span> <span class="cm-variable">line</span> <span class="cm-keyword">in</span> <span class="cm-variable">cell_input</span>.<span class="cm-property">splitlines</span>() <span class="cm-keyword">if</span> <span class="cm-keyword">not</span> <span class="cm-variable">line</span>.<span class="cm-property">startswith</span>(<span class="cm-string">'#'</span>))</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">last_input</span> = <span class="cm-variable">strip_comment_lines</span>(<span class="cm-variable">In</span>[<span class="cm-operator">-</span><span class="cm-number">2</span>])</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">test_info_command</span>():</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">assert</span> <span class="cm-string">'transfusion'</span> <span class="cm-keyword">in</span> <span class="cm-variable">last_input</span>, <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-string">"Expected transfusion variable in your input."</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">assert</span> <span class="cm-string">'info'</span> <span class="cm-keyword">in</span> <span class="cm-variable">last_input</span>, <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-string">"Did you use the correct method?"</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">assert</span> <span class="cm-string">'print'</span> <span class="cm-keyword">not</span> <span class="cm-keyword">in</span> <span class="cm-variable">last_input</span>, <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-string">"Please use transfusion.info() to inspect DataFrame's structure, not the display() or print() functions."</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 10px solid transparent; top: 283px;"></div><div class="CodeMirror-gutters" style="display: none; height: 313px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt"><bdi>Out</bdi>[7]:</div><div class="output_subarea output_text output_result"><pre>1/1 tests passed
</pre></div></div></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(240, 254, 255);"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59985px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -10px; border-right-width: 20px; min-height: 82px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: currentcolor none medium;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 19.6667px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span><span class="cm-header cm-header-2">## 4. Creating target column</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>We are aiming to predict the value in <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span>whether he/she donated blood in March 2007<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span> column. Let's rename this it to <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span>target<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span> so that it's more convenient to work with.<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 82px;"></div><div class="CodeMirror-gutters" style="display: none; height: 102px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="4.-Creating-target-column">4. Creating target column<a class="anchor-link" href="#4.-Creating-target-column">¶</a></h2>
<p>We are aiming to predict the value in <code>whether he/she donated blood in March 2007</code> column. Let's rename this it to <code>target</code> so that it's more convenient to work with.</p></div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[8]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.6001px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="display: block; right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 1942px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 1942.67px; margin-bottom: -10px; border-right-width: 20px; min-height: 147px; padding-right: 0px; padding-bottom: 10px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: currentcolor none medium;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-comment"># Rename target column as 'target' for brevity </span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">transfusion</span>.<span class="cm-property">rename</span>(</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">columns</span>={<span class="cm-string">'whether he/she donated blood in March 2007'</span>: <span class="cm-string">'target'</span>},</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">inplace</span>=<span class="cm-keyword">True</span></span></pre><pre class=" CodeMirror-line "><span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#By setting the inplace parameter of the rename() method to True, the transfusion DataFrame is changed in-place, i.e., the transfusion variable will now point to the updated DataFrame as you'll verify by printing the first 2 rows.</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># Print out the first 2 rows</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">transfusion</span>.<span class="cm-property">head</span>(<span class="cm-number">2</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 10px solid transparent; top: 147px;"></div><div class="CodeMirror-gutters" style="display: none; height: 177px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt"><bdi>Out</bdi>[8]:</div><div class="output_subarea output_html rendered_html output_result"><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="dataframe" border="1">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Recency (months)</th>
      <th>Frequency (times)</th>
      <th>Monetary (c.c. blood)</th>
      <th>Time (months)</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>50</td>
      <td>12500</td>
      <td>98</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>13</td>
      <td>3250</td>
      <td>28</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell unselected rendered" tabindex="2" style="display: none;"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[9]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.6001px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 10px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="display: block; right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 1200px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="height: 10px; width: 10px;"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 1200.53px; margin-bottom: -10px; border-right-width: 20px; min-height: 300px; padding-right: 0px; padding-bottom: 10px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: currentcolor none medium;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-operator">%%</span><span class="cm-variable">nose</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">last_output</span> = <span class="cm-variable">_</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">test_target_column_added</span>():</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">assert</span> <span class="cm-string">'target'</span> <span class="cm-keyword">in</span> <span class="cm-variable">transfusion</span>.<span class="cm-property">columns</span>, <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-string">"'target' column not found in transfusion.columns"</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">test_head_2_rows_only</span>():</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">try</span>:</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-keyword">assert</span> <span class="cm-variable">last_output</span>.<span class="cm-property">shape</span>[<span class="cm-number">0</span>] == <span class="cm-number">2</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">except</span> <span class="cm-variable">AttributeError</span>:</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-keyword">assert</span> <span class="cm-keyword">False</span>, <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>            <span class="cm-string">"Please use transfusion.head(2) as the last line of code in the cell to inspect the data, not the display() or print() functions."</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">except</span> <span class="cm-variable">AssertionError</span>:</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-keyword">assert</span> <span class="cm-keyword">False</span>, <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>            <span class="cm-string">"Did you call 'head()' method with the correct number of lines?"</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 10px solid transparent; top: 300px;"></div><div class="CodeMirror-gutters" style="display: none; height: 330px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt"><bdi>Out</bdi>[9]:</div><div class="output_subarea output_text output_result"><pre>2/2 tests passed
</pre></div></div></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(240, 254, 255);"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59985px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -10px; border-right-width: 20px; min-height: 218px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: currentcolor none medium;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 19.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-header cm-header-2">## 5. Checking target incidence</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>We want to predict whether or not the same donor will give blood the next time the vehicle comes to campus. The model for this is a binary classifier, meaning that there are only 2 possible outcomes:<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">ul</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">li</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span>0<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span> - the donor will not give blood<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">li</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">li</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span>1<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span> - the donor will give blood<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">li</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">ul</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>Target incidence is defined as the number of cases of each individual target value in a dataset. That is, how many 0s in the target column compared to how many 1s? Target incidence gives us an idea of how balanced (or imbalanced) is our dataset.<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 218px;"></div><div class="CodeMirror-gutters" style="display: none; height: 238px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="5.-Checking-target-incidence">5. Checking target incidence<a class="anchor-link" href="#5.-Checking-target-incidence">¶</a></h2>
<p>We want to predict whether or not the same donor will give blood the 
next time the vehicle comes to campus. The model for this is a binary 
classifier, meaning that there are only 2 possible outcomes:</p>
<ul>
<li><code>0</code> - the donor will not give blood</li>
<li><code>1</code> - the donor will give blood</li>
</ul>
<p>Target incidence is defined as the number of cases of each individual
 target value in a dataset. That is, how many 0s in the target column 
compared to how many 1s? Target incidence gives us an idea of how 
balanced (or imbalanced) is our dataset.</p></div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[10]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.6001px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="display: block; right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 618px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 618.633px; margin-bottom: -10px; border-right-width: 20px; min-height: 62px; padding-right: 0px; padding-bottom: 10px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: currentcolor none medium;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span><span class="cm-comment"># Print target incidence proportions, rounding output to 3 decimal places</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">transfusion</span>.<span class="cm-property">target</span>.<span class="cm-property">value_counts</span>(<span class="cm-variable">normalize</span>=<span class="cm-keyword">True</span>).<span class="cm-property">round</span>(<span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 10px solid transparent; top: 62px;"></div><div class="CodeMirror-gutters" style="display: none; height: 92px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt"><bdi>Out</bdi>[10]:</div><div class="output_subarea output_text output_result"><pre>0    0.762
1    0.238
Name: target, dtype: float64</pre></div></div></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell unselected rendered" tabindex="2" style="display: none;"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[11]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59985px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 10px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="display: block; right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 1225px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="height: 10px; width: 10px;"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 1225.83px; margin-bottom: -10px; border-right-width: 20px; min-height: 521px; padding-right: 0px; padding-bottom: 10px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: currentcolor none medium;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-operator">%%</span><span class="cm-variable">nose</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">strip_comment_lines</span>(<span class="cm-variable">cell_input</span>):</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-string">"""Returns cell input string with comment lines removed."""</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">return</span> <span class="cm-string">'\n'</span>.<span class="cm-property">join</span>(<span class="cm-variable">line</span> <span class="cm-keyword">for</span> <span class="cm-variable">line</span> <span class="cm-keyword">in</span> <span class="cm-variable">cell_input</span>.<span class="cm-property">splitlines</span>() <span class="cm-keyword">if</span> <span class="cm-keyword">not</span> <span class="cm-variable">line</span>.<span class="cm-property">startswith</span>(<span class="cm-string">'#'</span>))</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">last_input</span> = <span class="cm-variable">strip_comment_lines</span>(<span class="cm-variable">In</span>[<span class="cm-operator">-</span><span class="cm-number">2</span>])</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">last_output</span> = <span class="cm-variable">_</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">test_command_syntax</span>():</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">assert</span> <span class="cm-string">'transfusion.target'</span> <span class="cm-keyword">in</span> <span class="cm-variable">last_input</span>, <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-string">"Did you call 'value_counts()' method on 'transfusion.target' column?"</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">assert</span> (<span class="cm-string">'value_counts'</span> <span class="cm-keyword">in</span> <span class="cm-variable">last_input</span>) <span class="cm-keyword">and</span> (<span class="cm-string">'normalize'</span> <span class="cm-keyword">in</span> <span class="cm-variable">last_input</span>), <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-string">"Did you use 'normalize=True' parameter?"</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">assert</span> <span class="cm-string">'round'</span> <span class="cm-keyword">in</span> <span class="cm-variable">last_input</span>, <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-string">"Did you call 'round()' method?"</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">assert</span> <span class="cm-string">'round(3)'</span> <span class="cm-keyword">in</span> <span class="cm-variable">last_input</span>, <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-string">"Did you call 'round()' method with the correct argument?"</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">assert</span> <span class="cm-variable">last_input</span>.<span class="cm-property">find</span>(<span class="cm-string">'value'</span>) <span class="cm-operator">&lt;</span> <span class="cm-variable">last_input</span>.<span class="cm-property">find</span>(<span class="cm-string">'round'</span>), <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-string">"Did you chain 'value_counts()' and 'round()' methods in the correct order?"</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">test_command_output</span>():</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">try</span>:</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-keyword">assert</span> <span class="cm-string">"0.762"</span> <span class="cm-keyword">in</span> <span class="cm-variable">last_output</span>.<span class="cm-property">to_string</span>()</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">except</span> <span class="cm-variable">AttributeError</span>:</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-keyword">assert</span> <span class="cm-keyword">False</span>, <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>            <span class="cm-string">"Please use transfusion.target.value_counts(normalize=True).round(3) to inspect proportions, not the display() or print() functions."</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">except</span> <span class="cm-variable">AssertionError</span>:</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-keyword">assert</span> <span class="cm-keyword">False</span>, <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>            <span class="cm-string">"Hmm, the output of the cell is not what we expected. You should see 0.762 in your output."</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 10px solid transparent; top: 521px;"></div><div class="CodeMirror-gutters" style="display: none; height: 551px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt"><bdi>Out</bdi>[11]:</div><div class="output_subarea output_text output_result"><pre>2/2 tests passed
</pre></div></div></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(240, 254, 255);"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -10px; border-right-width: 20px; min-height: 184px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: currentcolor none medium;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 19.6667px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span><span class="cm-header cm-header-2">## 6. Splitting transfusion into train and test datasets</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>We'll now use <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span>train_test_split()<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span> method to split <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span>transfusion<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span> DataFrame.<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>Target incidence informed us that in our dataset <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span>0<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span>s appear 76% of the time. We want to keep the same structure in train and test datasets, i.e., both datasets must have 0 target incidence of 76%. This is very easy to do using the <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span>train_test_split()<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span> method from the <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span>scikit learn<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span> library - all we need to do is specify the <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span>stratify<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span> parameter. In our case, we'll stratify on the <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span>target<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span> column.<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 184px;"></div><div class="CodeMirror-gutters" style="display: none; height: 204px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="6.-Splitting-transfusion-into-train-and-test-datasets">6. Splitting transfusion into train and test datasets<a class="anchor-link" href="#6.-Splitting-transfusion-into-train-and-test-datasets">¶</a></h2>
<p>We'll now use <code>train_test_split()</code> method to split <code>transfusion</code> DataFrame.</p>
<p>Target incidence informed us that in our dataset <code>0</code>s 
appear 76% of the time. We want to keep the same structure in train and 
test datasets, i.e., both datasets must have 0 target incidence of 76%. 
This is very easy to do using the <code>train_test_split()</code> method from the <code>scikit learn</code> library - all we need to do is specify the <code>stratify</code> parameter. In our case, we'll stratify on the <code>target</code> column.</p></div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[12]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 441.533px; margin-bottom: -10px; border-right-width: 20px; min-height: 283px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: currentcolor none medium;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-comment"># Import train_test_split method</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">model_selection</span> <span class="cm-keyword">import</span> <span class="cm-variable">train_test_split</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># Split transfusion DataFrame into</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># X_train, X_test, y_train and y_test datasets,</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># stratifying on the `target` column</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">X_train</span>,<span class="cm-variable">X_test</span>,<span class="cm-variable">y_train</span>,<span class="cm-variable">y_test</span>= <span class="cm-variable">train_test_split</span>(</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">transfusion</span>.<span class="cm-property">drop</span>(<span class="cm-variable">columns</span>=<span class="cm-string">'target'</span>),</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">transfusion</span>.<span class="cm-property">target</span>,</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">test_size</span>=<span class="cm-number">0.25</span>,</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">random_state</span>=<span class="cm-number">42</span>,</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">stratify</span>=<span class="cm-variable">transfusion</span>.<span class="cm-property">target</span></span></pre><pre class=" CodeMirror-line "><span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># Print out the first 2 rows of X_train</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">X_train</span>.<span class="cm-property">head</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 283px;"></div><div class="CodeMirror-gutters" style="display: none; height: 303px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt"><bdi>Out</bdi>[12]:</div><div class="output_subarea output_html rendered_html output_result"><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="dataframe" border="1">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Recency (months)</th>
      <th>Frequency (times)</th>
      <th>Monetary (c.c. blood)</th>
      <th>Time (months)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>334</th>
      <td>16</td>
      <td>2</td>
      <td>500</td>
      <td>16</td>
    </tr>
    <tr>
      <th>99</th>
      <td>5</td>
      <td>7</td>
      <td>1750</td>
      <td>26</td>
    </tr>
    <tr>
      <th>116</th>
      <td>2</td>
      <td>7</td>
      <td>1750</td>
      <td>46</td>
    </tr>
    <tr>
      <th>661</th>
      <td>16</td>
      <td>2</td>
      <td>500</td>
      <td>16</td>
    </tr>
    <tr>
      <th>154</th>
      <td>2</td>
      <td>1</td>
      <td>250</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell unselected rendered" tabindex="2" style="display: none;"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[13]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.6001px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 10px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="display: block; right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 1166px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="height: 10px; width: 10px;"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 1166.8px; margin-bottom: -10px; border-right-width: 20px; min-height: 453px; padding-right: 0px; padding-bottom: 10px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: currentcolor none medium;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-operator">%%</span><span class="cm-variable">nose</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">last_output</span> = <span class="cm-variable">_</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">test_train_test_split_loaded</span>():</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">assert</span> <span class="cm-string">'train_test_split'</span> <span class="cm-keyword">in</span> <span class="cm-builtin">globals</span>(), <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-string">"'train_test_split' function not found. Please check your import statement."</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">test_X_train_created</span>():</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">correct_X_train</span>, <span class="cm-variable">_</span>, <span class="cm-variable">_</span>, <span class="cm-variable">_</span> = <span class="cm-variable">train_test_split</span>(<span class="cm-variable">transfusion</span>.<span class="cm-property">drop</span>(<span class="cm-variable">columns</span>=<span class="cm-string">'target'</span>),</span></pre><pre class=" CodeMirror-line "><span>                                                <span class="cm-variable">transfusion</span>.<span class="cm-property">target</span>,</span></pre><pre class=" CodeMirror-line "><span>                                                <span class="cm-variable">test_size</span>=<span class="cm-number">0.25</span>,</span></pre><pre class=" CodeMirror-line "><span>                                                <span class="cm-variable">random_state</span>=<span class="cm-number">42</span>,</span></pre><pre class=" CodeMirror-line "><span>                                                <span class="cm-variable">stratify</span>=<span class="cm-variable">transfusion</span>.<span class="cm-property">target</span>)</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">assert</span> <span class="cm-variable">correct_X_train</span>.<span class="cm-property">equals</span>(<span class="cm-variable">X_train</span>), <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-string">"'X_train' not created correctly. Did you stratify on the correct column?"</span></span></pre><pre class=" CodeMirror-line "><span>    </span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">test_head_output</span>():</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">try</span>:</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-keyword">assert</span> <span class="cm-string">"1750"</span> <span class="cm-keyword">in</span> <span class="cm-variable">last_output</span>.<span class="cm-property">to_string</span>()</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">except</span> <span class="cm-variable">AttributeError</span>:</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-keyword">assert</span> <span class="cm-keyword">False</span>, <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>            <span class="cm-string">"Please use X_train.head(2) as the last line of code in the cell to inspect the data, not the display() or print() functions."</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">except</span> <span class="cm-variable">AssertionError</span>:</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-keyword">assert</span> <span class="cm-keyword">False</span>, <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>            <span class="cm-string">"Hmm, the output of the cell is not what we expected. You should see 1750 in the first 2 rows of the X_train DataFrame."</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 10px solid transparent; top: 453px;"></div><div class="CodeMirror-gutters" style="display: none; height: 483px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt"><bdi>Out</bdi>[13]:</div><div class="output_subarea output_text output_result"><pre>3/3 tests passed
</pre></div></div></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(240, 254, 255);"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -10px; border-right-width: 20px; min-height: 235px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: currentcolor none medium;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 19.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-header cm-header-2">## 7. Selecting model using TPOT</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">href</span>=<span class="cm-string">"</span><span class="cm-string cm-link">https://github.com/EpistasisLab/tpot</span><span class="cm-string">"</span><span class="cm-tag cm-bracket">&gt;</span>TPOT<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span> is a Python Automated Machine Learning tool that optimizes machine learning pipelines using genetic programming.<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"</span><span class="cm-string cm-link">https://assets.datacamp.com/production/project_646/img/tpot-ml-pipeline.png</span><span class="cm-string">"</span> <span class="cm-attribute">alt</span>=<span class="cm-string">"TPOT Machine Learning Pipeline"</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>TPOT will automatically explore hundreds of possible pipelines to find the best one for our dataset. Note, the outcome of this search will be a <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">href</span>=<span class="cm-string">"</span><span class="cm-string cm-link">https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html</span><span class="cm-string">"</span><span class="cm-tag cm-bracket">&gt;</span>scikit-learn pipeline<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span>, meaning it will include any pre-processing steps as well as the model.<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>We are using TPOT to help us zero in on one model that we can then explore and optimize further.<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 235px;"></div><div class="CodeMirror-gutters" style="display: none; height: 255px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="7.-Selecting-model-using-TPOT">7. Selecting model using TPOT<a class="anchor-link" href="#7.-Selecting-model-using-TPOT">¶</a></h2>
<p><a href="https://github.com/EpistasisLab/tpot" target="_blank">TPOT</a> is a Python Automated Machine Learning tool that optimizes machine learning pipelines using genetic programming.</p>
<p><img src="notebook_data/tpot-ml-pipeline.png" alt="TPOT Machine Learning Pipeline"></p>
<p>TPOT will automatically explore hundreds of possible pipelines to 
find the best one for our dataset. Note, the outcome of this search will
 be a <a href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html" target="_blank">scikit-learn pipeline</a>, meaning it will include any pre-processing steps as well as the model.</p>
<p>We are using TPOT to help us zero in on one model that we can then explore and optimize further.</p></div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[14]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.6001px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 10px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="display: block; right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 659px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="height: 10px; width: 10px;"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 660.8px; margin-bottom: -10px; border-right-width: 20px; min-height: 436px; padding-right: 0px; padding-bottom: 10px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: currentcolor none medium;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-comment"># Import TPOTClassifier and roc_auc_score</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">tpot</span> <span class="cm-keyword">import</span> <span class="cm-variable">TPOTClassifier</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">metrics</span> <span class="cm-keyword">import</span> <span class="cm-variable">roc_auc_score</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># Instantiate TPOTClassifier</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">tpot</span> = <span class="cm-variable">TPOTClassifier</span>(</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">generations</span>=<span class="cm-number">5</span>,</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">population_size</span>=<span class="cm-number">20</span>,</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">verbosity</span>=<span class="cm-number">2</span>,</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">scoring</span>=<span class="cm-string">'roc_auc'</span>,</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">random_state</span>=<span class="cm-number">42</span>,</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">disable_update_check</span>=<span class="cm-keyword">True</span>,</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">config_dict</span>=<span class="cm-string">'TPOT light'</span></span></pre><pre class=" CodeMirror-line "><span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">tpot</span>.<span class="cm-property">fit</span>(<span class="cm-variable">X_train</span>, <span class="cm-variable">y_train</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># AUC score for tpot model  rounding it to 4 decimal places.</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">tpot_auc_score</span> = <span class="cm-variable">roc_auc_score</span>(<span class="cm-variable">y_test</span>, <span class="cm-variable">tpot</span>.<span class="cm-property">predict_proba</span>(<span class="cm-variable">X_test</span>)[:, <span class="cm-number">1</span>])</span></pre><pre class=" CodeMirror-line "><span><span class="cm-builtin">print</span>(<span class="cm-string">f'\nAUC score: {tpot_auc_score:.4f}'</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># Print best pipeline steps </span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-builtin">print</span>(<span class="cm-string">'\nBest pipeline steps:'</span>, <span class="cm-variable">end</span>=<span class="cm-string">'\n'</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">for</span> <span class="cm-variable">idx</span>, (<span class="cm-variable">name</span>, <span class="cm-variable">transform</span>) <span class="cm-keyword">in</span> <span class="cm-builtin">enumerate</span>(<span class="cm-variable">tpot</span>.<span class="cm-property">fitted_pipeline_</span>.<span class="cm-property">steps</span>, <span class="cm-variable">start</span>=<span class="cm-number">1</span>):</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-comment"># Print idx and transform</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-builtin">print</span>(<span class="cm-string">f'{idx}. {transform}'</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 10px solid transparent; top: 436px;"></div><div class="CodeMirror-gutters" style="display: none; height: 466px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text"><pre>HBox(children=(FloatProgress(value=0.0, description='Optimization Progress', max=120.0, style=ProgressStyle(de…</pre></div></div><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>Generation 1 - Current best internal CV score: 0.7433977184592779
Generation 2 - Current best internal CV score: 0.7433977184592779
Generation 3 - Current best internal CV score: 0.7433977184592779
Generation 4 - Current best internal CV score: 0.7433977184592779
Generation 5 - Current best internal CV score: 0.7433977184592779

Best pipeline: LogisticRegression(input_matrix, C=0.5, dual=False, penalty=l2)

AUC score: 0.7850

Best pipeline steps:
1. LogisticRegression(C=0.5, class_weight=None, dual=False, fit_intercept=True,
          intercept_scaling=1, max_iter=100, multi_class='warn',
          n_jobs=None, penalty='l2', random_state=None, solver='warn',
          tol=0.0001, verbose=0, warm_start=False)
</pre></div></div></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell unselected rendered" tabindex="2" style="display: none;"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[15]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 10px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="display: block; right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 1006px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="height: 10px; width: 10px;"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 1006.57px; margin-bottom: -10px; border-right-width: 20px; min-height: 436px; padding-right: 0px; padding-bottom: 10px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: currentcolor none medium;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-operator">%%</span><span class="cm-variable">nose</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">strip_comment_lines</span>(<span class="cm-variable">cell_input</span>):</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-string">"""Returns cell input string with comment lines removed."""</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">return</span> <span class="cm-string">'\n'</span>.<span class="cm-property">join</span>(<span class="cm-variable">line</span> <span class="cm-keyword">for</span> <span class="cm-variable">line</span> <span class="cm-keyword">in</span> <span class="cm-variable">cell_input</span>.<span class="cm-property">splitlines</span>() <span class="cm-keyword">if</span> <span class="cm-keyword">not</span> <span class="cm-variable">line</span>.<span class="cm-property">startswith</span>(<span class="cm-string">'#'</span>))</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">last_input</span> = <span class="cm-variable">strip_comment_lines</span>(<span class="cm-variable">In</span>[<span class="cm-operator">-</span><span class="cm-number">2</span>])</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">test_TPOTClassifier_loaded</span>():</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">assert</span> <span class="cm-string">'TPOTClassifier'</span> <span class="cm-keyword">in</span> <span class="cm-builtin">globals</span>(), <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-string">"'TPOTClassifier' class not found. Please check your import statement."</span></span></pre><pre class=" CodeMirror-line "><span>    </span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">test_roc_auc_score_loaded</span>():</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">assert</span> <span class="cm-string">'roc_auc_score'</span> <span class="cm-keyword">in</span> <span class="cm-builtin">globals</span>(), <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-string">"'roc_auc_score' function not found. Please check your import statement."</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">test_TPOTClassifier_instantiated</span>():</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">assert</span> <span class="cm-builtin">isinstance</span>(<span class="cm-variable">tpot</span>, <span class="cm-variable">TPOTClassifier</span>), <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-string">"'tpot' is not an instance of TPOTClassifier. Did you assign an instance of TPOTClassifier to 'tpot' variable?"</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">test_pipeline_steps_printed</span>():</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">assert</span> <span class="cm-string">'{idx}'</span> <span class="cm-keyword">in</span> <span class="cm-variable">last_input</span>, <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-string">"Did you use {idx} variable in the f-string in the print statement?"</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">assert</span> <span class="cm-string">'{transform}'</span> <span class="cm-keyword">in</span> <span class="cm-variable">last_input</span>, <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-string">"Did you use {transform} variable in the f-string in the print statement?"</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 10px solid transparent; top: 436px;"></div><div class="CodeMirror-gutters" style="display: none; height: 466px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt"><bdi>Out</bdi>[15]:</div><div class="output_subarea output_text output_result"><pre>4/4 tests passed
</pre></div></div></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(240, 254, 255);"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.6001px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -10px; border-right-width: 20px; min-height: 252px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: currentcolor none medium;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 19.6667px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span><span class="cm-header cm-header-2">## 8. Checking the variance</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>TPOT picked <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span>LogisticRegression<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span> as the best model for our dataset with no pre-processing steps, giving us the AUC score of 0.7850. This is a great starting point. Let's see if we can make it better.<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>One of the assumptions for linear regression models is that the data and the features we are giving it are related in a linear fashion, or can be measured with a linear distance metric. If a feature in our dataset has a high variance that's an order of magnitude or more greater than the other features, this could impact the model's ability to learn from other features in the dataset.<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>Correcting for high variance is called normalization. It is one of the possible transformations you do before training a model. Let's check the variance to see if such transformation is needed.<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 252px;"></div><div class="CodeMirror-gutters" style="display: none; height: 272px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="8.-Checking-the-variance">8. Checking the variance<a class="anchor-link" href="#8.-Checking-the-variance">¶</a></h2>
<p>TPOT picked <code>LogisticRegression</code> as the best model for our
 dataset with no pre-processing steps, giving us the AUC score of 
0.7850. This is a great starting point. Let's see if we can make it 
better.</p>
<p>One of the assumptions for linear regression models is that the data 
and the features we are giving it are related in a linear fashion, or 
can be measured with a linear distance metric. If a feature in our 
dataset has a high variance that's an order of magnitude or more greater
 than the other features, this could impact the model's ability to learn
 from other features in the dataset.</p>
<p>Correcting for high variance is called normalization. It is one of 
the possible transformations you do before training a model. Let's check
 the variance to see if such transformation is needed.</p></div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[16]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.6001px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 517.433px; margin-bottom: -10px; border-right-width: 20px; min-height: 45px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: currentcolor none medium;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span><span class="cm-comment"># X_train's variance, rounding the output to 3 decimal places</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">X_train</span>.<span class="cm-property">var</span>().<span class="cm-property">round</span>(<span class="cm-number">3</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 45px;"></div><div class="CodeMirror-gutters" style="display: none; height: 65px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt"><bdi>Out</bdi>[16]:</div><div class="output_subarea output_text output_result"><pre>Recency (months)              66.929
Frequency (times)             33.830
Monetary (c.c. blood)    2114363.700
Time (months)                611.147
dtype: float64</pre></div></div></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell unselected rendered" tabindex="2" style="display: none;"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[17]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.6001px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 10px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="display: block; right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 946px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="height: 10px; width: 10px;"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 947.533px; margin-bottom: -10px; border-right-width: 20px; min-height: 487px; padding-right: 0px; padding-bottom: 10px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: currentcolor none medium;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-operator">%%</span><span class="cm-variable">nose</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">strip_comment_lines</span>(<span class="cm-variable">cell_input</span>):</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-string">"""Returns cell input string with comment lines removed."""</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">return</span> <span class="cm-string">'\n'</span>.<span class="cm-property">join</span>(<span class="cm-variable">line</span> <span class="cm-keyword">for</span> <span class="cm-variable">line</span> <span class="cm-keyword">in</span> <span class="cm-variable">cell_input</span>.<span class="cm-property">splitlines</span>() <span class="cm-keyword">if</span> <span class="cm-keyword">not</span> <span class="cm-variable">line</span>.<span class="cm-property">startswith</span>(<span class="cm-string">'#'</span>))</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">last_input</span> = <span class="cm-variable">strip_comment_lines</span>(<span class="cm-variable">In</span>[<span class="cm-operator">-</span><span class="cm-number">2</span>])</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">last_output</span> = <span class="cm-variable">_</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">test_command_syntax</span>():</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">assert</span> <span class="cm-string">'X_train'</span> <span class="cm-keyword">in</span> <span class="cm-variable">last_input</span>, <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-string">"Did you call 'var()' method on 'X_train' DataFrame?"</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">assert</span> <span class="cm-string">'var'</span> <span class="cm-keyword">in</span> <span class="cm-variable">last_input</span>, <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-string">"Did you call 'var()' method?"</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">assert</span> <span class="cm-string">'round(3)'</span> <span class="cm-keyword">in</span> <span class="cm-variable">last_input</span>, <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-string">"Did you call 'round()' method with the correct argument?"</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">assert</span> <span class="cm-variable">last_input</span>.<span class="cm-property">find</span>(<span class="cm-string">'var'</span>) <span class="cm-operator">&lt;</span> <span class="cm-variable">last_input</span>.<span class="cm-property">find</span>(<span class="cm-string">'round'</span>), <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-string">"Did you chain 'var()' and 'round()' methods in the correct order?"</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">test_var_output</span>():</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">try</span>:</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-keyword">assert</span> <span class="cm-string">"2114363"</span> <span class="cm-keyword">in</span> <span class="cm-variable">last_output</span>.<span class="cm-property">to_string</span>()</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">except</span> <span class="cm-variable">AttributeError</span>:</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-keyword">assert</span> <span class="cm-keyword">False</span>, <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>            <span class="cm-string">"Please use X_train.var().round(3) to inspect the variance, not the display() or print() functions."</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">except</span> <span class="cm-variable">AssertionError</span>:</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-keyword">assert</span> <span class="cm-keyword">False</span>, <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>            <span class="cm-string">"Hmm, the output of the cell is not what we expected. You should see 2114363 in your output."</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 10px solid transparent; top: 487px;"></div><div class="CodeMirror-gutters" style="display: none; height: 517px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt"><bdi>Out</bdi>[17]:</div><div class="output_subarea output_text output_result"><pre>2/2 tests passed
</pre></div></div></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(240, 254, 255);"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -10px; border-right-width: 20px; min-height: 133px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: currentcolor none medium;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 19.6667px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span><span class="cm-header cm-header-2">## 9. Log normalization</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span>Monetary (c.c. blood)<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span>'s variance is very high in comparison to any other column in the dataset. This means that, unless accounted for, this feature may get more weight by the model (i.e., be seen as more important) than any other feature.<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>One way to correct for high variance is to use log normalization.<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 133px;"></div><div class="CodeMirror-gutters" style="display: none; height: 153px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="9.-Log-normalization">9. Log normalization<a class="anchor-link" href="#9.-Log-normalization">¶</a></h2>
<p><code>Monetary (c.c. blood)</code>'s variance is very high in 
comparison to any other column in the dataset. This means that, unless 
accounted for, this feature may get more weight by the model (i.e., be 
seen as more important) than any other feature.</p>
<p>One way to correct for high variance is to use log normalization.</p></div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[18]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 534.3px; margin-bottom: -10px; border-right-width: 20px; min-height: 317px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: currentcolor none medium;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-comment"># Import numpy</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">import</span> <span class="cm-variable">numpy</span> <span class="cm-keyword">as</span> <span class="cm-variable">np</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># Copy X_train and X_test into X_train_normed and X_test_normed</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">X_train_normed</span>,<span class="cm-variable">X_test_normed</span> = <span class="cm-variable">X_train</span>.<span class="cm-property">copy</span>(), <span class="cm-variable">X_test</span>.<span class="cm-property">copy</span>()</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># Specify which column to normalize</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">col_to_normalize</span> = <span class="cm-string">'Monetary (c.c. blood)'</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># Log normalization</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">for</span> <span class="cm-variable">df_</span> <span class="cm-keyword">in</span> [<span class="cm-variable">X_train_normed</span>, <span class="cm-variable">X_test_normed</span>]:</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-comment"># Add log normalized column</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">df_</span>[<span class="cm-string">'monetary_log'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">log</span>(<span class="cm-variable">df_</span>[<span class="cm-variable">col_to_normalize</span>])</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-comment"># Drop the original column</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">df_</span>.<span class="cm-property">drop</span>(<span class="cm-variable">columns</span>=<span class="cm-variable">col_to_normalize</span>, <span class="cm-variable">inplace</span>=<span class="cm-keyword">True</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># Check the variance for X_train_normed</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">X_train_normed</span>.<span class="cm-property">var</span>().<span class="cm-property">round</span>(<span class="cm-number">3</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 317px;"></div><div class="CodeMirror-gutters" style="display: none; height: 337px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt"><bdi>Out</bdi>[18]:</div><div class="output_subarea output_text output_result"><pre>Recency (months)      66.929
Frequency (times)     33.830
Time (months)        611.147
monetary_log           0.837
dtype: float64</pre></div></div></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell unselected rendered" tabindex="2" style="display: none;"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[19]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 10px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="display: block; right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 1317px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="height: 10px; width: 10px;"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 1318.6px; margin-bottom: -10px; border-right-width: 20px; min-height: 555px; padding-right: 0px; padding-bottom: 10px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: currentcolor none medium;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-operator">%%</span><span class="cm-variable">nose</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">last_output</span> = <span class="cm-variable">_</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">test_numpy_loaded</span>():</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">assert</span> <span class="cm-string">'np'</span> <span class="cm-keyword">in</span> <span class="cm-builtin">globals</span>(), <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-string">"'np' module not found. Please check your import statement."</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">test_X_train_normed_created</span>():</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">assert</span> <span class="cm-string">'X_train_normed'</span> <span class="cm-keyword">in</span> <span class="cm-builtin">globals</span>(), <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-string">"'X_train_normed' DataFrame not found. Please check your variable assignment statement."</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">test_col_to_normalize</span>():</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">assert</span> <span class="cm-variable">col_to_normalize</span> == <span class="cm-string">'Monetary (c.c. blood)'</span>, <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-string">"'col_to_normalize' is set to an incorrect column name."</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">test_X_train_normed_log_normalized</span>():</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">correct_X_train_normed</span> = <span class="cm-variable">X_train</span>.<span class="cm-property">copy</span>() <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>        .<span class="cm-property">assign</span>(<span class="cm-variable">monetary_log</span> = <span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: <span class="cm-variable">np</span>.<span class="cm-property">log</span>(<span class="cm-variable">x</span>[<span class="cm-string">'Monetary (c.c. blood)'</span>])) <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>        .<span class="cm-property">drop</span>(<span class="cm-variable">columns</span>=<span class="cm-string">'Monetary (c.c. blood)'</span>)</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">assert</span> <span class="cm-variable">correct_X_train_normed</span>.<span class="cm-property">equals</span>(<span class="cm-variable">X_train_normed</span>), <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-string">"'X_train_normed' is incorrect. Are you 'col_to_normalize' in the loop? Did you 'col_to_normalize'?"</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">test_var_output</span>():</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">try</span>:</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-keyword">assert</span> <span class="cm-string">"611.147"</span> <span class="cm-keyword">in</span> <span class="cm-variable">last_output</span>.<span class="cm-property">to_string</span>()</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">except</span> <span class="cm-variable">AttributeError</span>:</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-keyword">assert</span> <span class="cm-keyword">False</span>, <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>            <span class="cm-string">"Please use X_train_normed.var().round(3) as the last line of code in the cell to inspect the variance, not the display() or print() functions."</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">except</span> <span class="cm-variable">AssertionError</span>:</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-keyword">assert</span> <span class="cm-keyword">False</span>, <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>            <span class="cm-string">"Hmm, the output of the cell is not what we expected. You should see 611.147 in your output."</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 10px solid transparent; top: 555px;"></div><div class="CodeMirror-gutters" style="display: none; height: 585px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt"><bdi>Out</bdi>[19]:</div><div class="output_subarea output_text output_result"><pre>5/5 tests passed
</pre></div></div></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(240, 254, 255);"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.60059px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -10px; border-right-width: 20px; min-height: 133px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: currentcolor none medium;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 19.6667px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span><span class="cm-header cm-header-2">## 10. Training the linear regression model</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>The variance looks much better now. Notice that now <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span>Time (months)<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span> has the largest variance, but it's not the <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">href</span>=<span class="cm-string">"</span><span class="cm-string cm-link">https://en.wikipedia.org/wiki/Order_of_magnitude</span><span class="cm-string">"</span><span class="cm-tag cm-bracket">&gt;</span>orders of magnitude<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span> higher than the rest of the variables, so we'll leave it as is.<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>We are now ready to train the linear regression model.<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 133px;"></div><div class="CodeMirror-gutters" style="display: none; height: 153px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="10.-Training-the-linear-regression-model">10. Training the linear regression model<a class="anchor-link" href="#10.-Training-the-linear-regression-model">¶</a></h2>
<p>The variance looks much better now. Notice that now <code>Time (months)</code> has the largest variance, but it's not the <a href="https://en.wikipedia.org/wiki/Order_of_magnitude" target="_blank">orders of magnitude</a> higher than the rest of the variables, so we'll leave it as is.</p>
<p>We are now ready to train the linear regression model.</p></div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[20]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.60059px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 10px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="display: block; right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 702px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="height: 10px; width: 10px;"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 702.967px; margin-bottom: -10px; border-right-width: 20px; min-height: 266px; padding-right: 0px; padding-bottom: 10px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: currentcolor none medium;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-comment"># Importing modules</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span> <span class="cm-keyword">import</span> <span class="cm-variable">linear_model</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># Instantiate LogisticRegression</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">logreg</span> = <span class="cm-variable">linear_model</span>.<span class="cm-property">LogisticRegression</span>(</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">solver</span>=<span class="cm-string">'liblinear'</span>,</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">random_state</span>=<span class="cm-number">42</span></span></pre><pre class=" CodeMirror-line "><span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># Train the model</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">logreg</span>.<span class="cm-property">fit</span>(<span class="cm-variable">X_train_normed</span>, <span class="cm-variable">y_train</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># AUC score for tpot model</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">logreg_auc_score</span> = <span class="cm-variable">roc_auc_score</span>(<span class="cm-variable">y_test</span>, <span class="cm-variable">logreg</span>.<span class="cm-property">predict_proba</span>(<span class="cm-variable">X_test_normed</span>)[:, <span class="cm-number">1</span>])</span></pre><pre class=" CodeMirror-line "><span><span class="cm-builtin">print</span>(<span class="cm-string">f'\nAUC score: {logreg_auc_score:.4f}'</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 10px solid transparent; top: 266px;"></div><div class="CodeMirror-gutters" style="display: none; height: 296px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>
AUC score: 0.7891
</pre></div></div></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell unselected rendered" tabindex="2" style="display: none;"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[21]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 10px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="display: block; right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 913px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="height: 10px; width: 10px;"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 913.8px; margin-bottom: -10px; border-right-width: 20px; min-height: 385px; padding-right: 0px; padding-bottom: 10px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: currentcolor none medium;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-operator">%%</span><span class="cm-variable">nose</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">test_linear_model_loaded</span>():</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">assert</span> <span class="cm-string">'linear_model'</span> <span class="cm-keyword">in</span> <span class="cm-builtin">globals</span>(), <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-string">"'linear_model' module not found. Please check your import statement."</span></span></pre><pre class=" CodeMirror-line "><span>    </span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">test_roc_auc_score_loaded</span>():</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">assert</span> <span class="cm-string">'roc_auc_score'</span> <span class="cm-keyword">in</span> <span class="cm-builtin">globals</span>(), <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-string">"'roc_auc_score' function not found. Please check your import statement."</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">test_LogisticRegression_instantiated</span>():</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">assert</span> <span class="cm-builtin">isinstance</span>(<span class="cm-variable">logreg</span>, <span class="cm-variable">linear_model</span>.<span class="cm-property">LogisticRegression</span>), <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>        (<span class="cm-string">"'logreg' is not an instance of linear_model.LogisticRegression. "</span></span></pre><pre class=" CodeMirror-line "><span>         <span class="cm-string">"Did you assign an instance of linear_model.LogisticRegression to 'logreg' variable?"</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">test_model_fitted</span>():</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">assert</span> <span class="cm-builtin">hasattr</span>(<span class="cm-variable">logreg</span>, <span class="cm-string">'coef_'</span>), <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-string">"Did you call 'fit()' method on 'logreg'?"</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">test_logreg_auc_score</span>():</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">assert</span> <span class="cm-string">'{:.4f}'</span>.<span class="cm-property">format</span>(<span class="cm-variable">logreg_auc_score</span>) == <span class="cm-string">'0.7891'</span>, <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-string">"Hmm, the logreg_auc_score is not what we expected. You should see 'AUC score: 0.7891' printed out."</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 10px solid transparent; top: 385px;"></div><div class="CodeMirror-gutters" style="display: none; height: 415px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt"><bdi>Out</bdi>[21]:</div><div class="output_subarea output_text output_result"><pre>5/5 tests passed
</pre></div></div></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(240, 254, 255);"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -10px; border-right-width: 20px; min-height: 320px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: currentcolor none medium;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 19.6667px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span><span class="cm-header cm-header-2">## 11. Conclusion</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>The demand for blood fluctuates throughout the year. As one <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">href</span>=<span class="cm-string">"</span><span class="cm-string cm-link">https://www.kjrh.com/news/local-news/red-cross-in-blood-donation-crisis</span><span class="cm-string">"</span><span class="cm-tag cm-bracket">&gt;</span>prominent<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span> example, blood donations slow down during busy holiday seasons. An accurate forecast for the future supply of blood allows for an appropriate action to be taken ahead of time and therefore saving more lives.<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>In this notebook, we explored automatic model selection using TPOT and AUC score we got was 0.7850. This is better than simply choosing <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span>0<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span> all the time (the target incidence suggests that such a model would have 76% success rate). We then log normalized our training data and improved the AUC score by 0.5%. In the field of machine learning, even small improvements in accuracy can be important, depending on the purpose.<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>Another benefit of using logistic regression model is that it is interpretable. We can analyze how much of the variance in the response variable (<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span>target<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">code</span><span class="cm-tag cm-bracket">&gt;</span>) can be explained by other variables in our dataset.<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 320px;"></div><div class="CodeMirror-gutters" style="display: none; height: 340px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="11.-Conclusion">11. Conclusion<a class="anchor-link" href="#11.-Conclusion">¶</a></h2>
<p>The demand for blood fluctuates throughout the year. As one <a href="https://www.kjrh.com/news/local-news/red-cross-in-blood-donation-crisis" target="_blank">prominent</a>
 example, blood donations slow down during busy holiday seasons. An 
accurate forecast for the future supply of blood allows for an 
appropriate action to be taken ahead of time and therefore saving more 
lives.</p>
<p>In this notebook, we explored automatic model selection using TPOT 
and AUC score we got was 0.7850. This is better than simply choosing <code>0</code>
 all the time (the target incidence suggests that such a model would 
have 76% success rate). We then log normalized our training data and 
improved the AUC score by 0.5%. In the field of machine learning, even 
small improvements in accuracy can be important, depending on the 
purpose.</p>
<p>Another benefit of using logistic regression model is that it is 
interpretable. We can analyze how much of the variance in the response 
variable (<code>target</code>) can be explained by other variables in our dataset.</p></div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[22]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 517.433px; margin-bottom: -10px; border-right-width: 20px; min-height: 164px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: currentcolor none medium;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-comment"># Importing itemgetter</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">operator</span> <span class="cm-keyword">import</span> <span class="cm-variable">itemgetter</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># Sort models based on their AUC score from highest to lowest</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-builtin">sorted</span>(</span></pre><pre class=" CodeMirror-line "><span>    [(<span class="cm-string">'tpot'</span>, <span class="cm-variable">tpot_auc_score</span>), (<span class="cm-string">'logreg'</span>, <span class="cm-variable">logreg_auc_score</span>)],</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">key</span>=<span class="cm-variable">itemgetter</span>(<span class="cm-number">1</span>),</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">reverse</span>=<span class="cm-keyword">True</span></span></pre><pre class=" CodeMirror-line "><span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 164px;"></div><div class="CodeMirror-gutters" style="display: none; height: 184px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt"><bdi>Out</bdi>[22]:</div><div class="output_subarea output_text output_result"><pre>[('logreg', 0.7890972663699937), ('tpot', 0.7849650349650349)]</pre></div></div></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2" style="display: none;"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[23]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.60059px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; display: block;"><div style="min-width: 1px; height: 45px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="right: 10px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="height: 10px; width: 10px;"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 3px; margin-bottom: -10px; border-right-width: 20px; min-height: 266px; padding-right: 10px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: currentcolor none medium;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"><pre class="CodeMirror-line"><span>        <span class="cm-string">"Hmm, the output of the cell is not what we expected. You should see 0.7851 as 'logreg' score in your output."</span></span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-operator">%%</span><span class="cm-variable">nose</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">last_output</span> = <span class="cm-variable">_</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">test_itemgetter_loaded</span>():</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">assert</span> <span class="cm-string">'itemgetter'</span> <span class="cm-keyword">in</span> <span class="cm-builtin">globals</span>(), <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-string">"'itemgetter' function not found. Please check your import statement."</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">test_logreg_is_first_in_the_list</span>():</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">assert</span> <span class="cm-variable">last_output</span>[<span class="cm-number">0</span>][<span class="cm-number">0</span>] == <span class="cm-string">'logreg'</span>, <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-string">"Expected 'logreg' to be first in the list."</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">test_logreg_score</span>():</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">assert</span> <span class="cm-builtin">round</span>(<span class="cm-variable">last_output</span>[<span class="cm-number">0</span>][<span class="cm-number">1</span>], <span class="cm-number">4</span>) == <span class="cm-number">0.7891</span>, <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-string">"Hmm, the output of the cell is not what we expected. You should see 0.7851 as 'logreg' score in your output."</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 266px;"></div><div class="CodeMirror-gutters" style="display: none; height: 296px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt"><bdi>Out</bdi>[23]:</div><div class="output_subarea output_text output_result"><pre>3/3 tests passed
</pre></div></div></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div></div><div class="end_space"></div></div>
        <div id="tooltip" class="ipython_tooltip" style="display:none"><div class="tooltipbuttons"><a href="#" role="button" class="ui-button"><span class="ui-icon ui-icon-close">Close</span></a><a href="#" class="ui-corner-all" role="button" id="expanbutton" title="Grow the tooltip vertically (press shift-tab twice)"><span class="ui-icon ui-icon-plus">Expand</span></a><a href="#" role="button" class="ui-button" title="show the current docstring in pager (press shift-tab 4 times)"><span class="ui-icon ui-icon-arrowstop-l-n">Open in Pager</span></a><a href="#" role="button" class="ui-button" title="Tooltip will linger for 10 seconds while you type" style="display: none;"><span class="ui-icon ui-icon-clock">Close</span></a></div><div class="pretooltiparrow"></div><div class="tooltiptext smalltooltip"></div></div>
    </div>
</div>



</div>



<div id="pager" class="ui-resizable">
    <div id="pager-contents">
        <div id="pager-container" class="container"></div>
    </div>
    <div id="pager-button-area"><a role="button" title="Open the pager in an external window" class="ui-button"><span class="ui-icon ui-icon-extlink"></span></a><a role="button" title="Close the pager" class="ui-button"><span class="ui-icon ui-icon-close"></span></a></div>
<div class="ui-resizable-handle ui-resizable-n" style="z-index: 90;"></div></div>






<script type="text/javascript">
    sys_info = {"notebook_version": "5.1.0", "notebook_path": "/usr/local/lib/python3.6/dist-packages/notebook", "commit_source": "", "commit_hash": "", "sys_version": "3.6.7 (default, Oct 22 2018, 11:32:17) \n[GCC 8.2.0]", "sys_executable": "/usr/bin/python3", "sys_platform": "linux", "platform": "Linux-4.14.171-105.231.amzn1.x86_64-x86_64-with-Ubuntu-18.04-bionic", "os_name": "posix", "default_encoding": "UTF-8"};
</script>

<script src="notebook_data/encoding.js" charset="utf-8"></script>

<script src="notebook_data/main_003.js" type="text/javascript" charset="utf-8"></script>



<script type="text/javascript">
  function _remove_token_from_url() {
    if (window.location.search.length <= 1) {
      return;
    }
    var search_parameters = window.location.search.slice(1).split('&');
    for (var i = 0; i < search_parameters.length; i++) {
      if (search_parameters[i].split('=')[0] === 'token') {
        // remote token from search parameters
        search_parameters.splice(i, 1);
        var new_search = '';
        if (search_parameters.length) {
          new_search = '?' + search_parameters.join('&');
        }
        var new_url = window.location.origin + 
                      window.location.pathname + 
                      new_search + 
                      window.location.hash;
        window.history.replaceState({}, "", new_url);
        return;
      }
    }
  }
  _remove_token_from_url();
</script>


<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px none; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px none; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-size-adjust: none;"></div></div></body></html>